<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exerc√≠ciodoAlien-Arthur Bretas</title>
    <script src="phaser.js"></script>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
        }
    </style>
</head>

<body>
    <script>
        // delimita o tamanho do jogo na tela
        const larguraJogo = 700;
        const alturaJogo = 850;

        // carrega as configuracoes de largura e altura do jogo
        const config = {
            type: Phaser.AUTO,
            width: larguraJogo,
            height: alturaJogo,

            physics: {
                //ativando a fisica do jogo
                default: 'arcade',
                arcade: {
                    gravity: { y: 300 },
                    debug: true
                }
            },

            scene: {
                preload: preload,
                create: create,
                update: update
            }
        };

        // Criamos uma constante 'game' que inicializa as configuracaoes presentes na funcao Phaser.game
        const game = new Phaser.Game(config);
        //cria variavel para o futuro alien(personagem) no jogo
        var alien;
        let keyA;
        let keyD;
        let keyW;
        var fire;
        var base;
        var base2;
        var base3;
        var coin;
        var score = 0;
        var scoreBoard;
        function preload() {
            //Carrega as imagens que utilizaremos em nosso jogo
            this.load.image('background', 'assets/bg.png');
            this.load.image('alien', 'assets/alienigena.png');
            this.load.image('fire', 'assets/turbo_roxo1.png');
            this.load.image('brick_base', 'assets/tijolos.png');
            this.load.image('coin', 'assets/moeda.png');
        }

        function create() {
            // A funcao create, cria as imagens pre-carregadas pela funcao preload
            this.add.image(larguraJogo / 2, alturaJogo / 2, 'background');
            //adiciona o turbo abaixo da nave
            fire = this.add.sprite(0, 0, 'fire');
            fire.setVisible(false);

            alien = this.physics.add.sprite(larguraJogo / 2, 0, 'alien');
            //adiciona colisao ao jogo
            alien.setCollideWorldBounds(true);
            alien.body.setSize(80, 80, true);

            //teclas A,W,D para movimento
            keyA = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.A);
            keyD = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.D);
            keyW = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.W);

            //adiciona plataforma

            base = this.physics.add.staticImage(larguraJogo / 3, alturaJogo / 1.5, 'brick_base');
            this.physics.add.collider(alien, base);
            base2 = this.physics.add.staticImage((larguraJogo / 2) + 17, alturaJogo / 2, 'brick_base');
            this.physics.add.collider(alien, base2);
            base3 = this.physics.add.staticImage((larguraJogo / 2) + 150, alturaJogo / 1.5, 'brick_base');
            this.physics.add.collider(alien, base3);

            //adicona as moedas
            coin = this.physics.add.sprite(larguraJogo / 2, 0, 'coin');
            coin.setCollideWorldBounds(true);
            coin.setBounce(0.7);
            this.physics.add.collider(coin, base);
            this.physics.add.collider(coin, base2);
            this.physics.add.collider(coin, base3);

            //adiciona placar
            scoreBoard = this.add.text(50, 50, 'score:' + score, { fontSize: '45px', fill: '#495613' });
            //interacao alien moeda
            this.physics.add.overlap(alien, coin, function () {

                coin.setVisible(false); // moeda fica invisivel

                var coinPosition_Y = Phaser.Math.RND.between(50, 650);//sorteador

                coin.setPosition(coinPosition_Y, 100);//ajusta posicao

                score += 1; // soma a pontuacao

                scoreBoard.setText('score:' + score);//atualiza o texto do placar

                coin.setVisible(true);// ativa a visao da moeda

            });
        }

        //logica de movimento
        function update() {
            //movimento para a esquerda
            if (keyA.isDown) {
                alien.setVelocityX(-150);
                //movimento para a direita
            } else if (keyD.isDown) {
                alien.setVelocityX(150);
                //sem movimento
            } else {
                alien.setVelocityX(0);
            }   //movimento para cima
            if (keyW.isDown) {
                alien.setVelocityY(-150);
                turboOn();
            }   //acao da gravidade
            else {
                turboOff();
            }
            fire.setPosition(alien.x, alien.y + alien.height / 2);
        }
        function turboOn() { //ativa o turbo
            fire.setVisible(true);
        }
        function turboOff() { //desativa o turbo
            fire.setVisible(false);
        }
    </script>
</body>

</html>